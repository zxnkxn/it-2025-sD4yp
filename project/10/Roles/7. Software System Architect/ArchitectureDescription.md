# Архитектура программной системы

## 1. Общая характеристика архитектуры

Проектируемая система представляет собой клиент-серверное приложение с централизованной серверной логикой и единой базой данных. Архитектура построена по модульному принципу с чётким разделением ответственности между компонентами.

Основные архитектурные уровни:

* **Клиентский уровень** — пользовательский интерфейс;
* **Прикладной уровень** — центральное приложение и сервисы предметной области;
* **Уровень данных** — база данных.

Взаимодействие между компонентами осуществляется через явно определённые интерфейсы (REST API и внутренние сервисные вызовы).

---

## 2. Перечень программных компонентов и их ответственности

### 2.1 User Interface

**Тип:** компонент  
**Артефакт:** `UI`

**Ответственности:**

* Отображение пользовательского интерфейса;
* Сбор пользовательского ввода (авторизация, выбор игр, выставление оценок);
* Отправка HTTP-запросов к серверной части;
* Отображение полученных данных (рекомендации, страницы игр, отзывы);
* Хранение токена аутентификации на клиенте;
* Навигация между страницами приложения.

User Interface не содержит бизнес-логики и выступает исключительно как клиент к API серверной части.

---

### 2.2 CoreApp

**Тип:** компонент  
**Артефакт:** `CoreApp`

**Ответственности:**

* Централизованная точка входа для всех клиентских запросов;
* Обработка REST API запросов;
* Оркестрация взаимодействия между сервисными компонентами;
* Агрегация данных из различных менеджеров;
* Формирование ответов для клиентского интерфейса;
* Контроль сценариев работы системы.

CoreApp не хранит бизнес-данные, а координирует работу специализированных компонентов.

---

### 2.3 Auth Manager

**Тип:** компонент  
**Артефакт:** `Services`

**Ответственности:**

* Аутентификация пользователей;
* Проверка корректности учётных данных;
* Управление авторизацией;
* Генерация и валидация токенов доступа.

---

### 2.4 User Manager

**Тип:** компонент  
**Артефакт:** `Services`

**Ответственности:**

* Управление профилями пользователей;
* Хранение и предоставление пользовательских настроек;
* Работа с предпочтениями пользователя (жанры, интересы).

---

### 2.5 Game Manager

**Тип:** компонент  
**Артефакт:** `Services`

**Ответственности:**

* Управление данными об играх;
* Предоставление информации об играх по идентификатору.

---

### 2.6 Rating Manager

**Тип:** компонент  
**Артефакт:** `Services`

**Ответственности:**

* Хранение пользовательских оценок;
* Хранение и обработка отзывов;
* Предоставление агрегированных оценок игр.

---

### 2.7 Recommendation Manager

**Тип:** компонент  
**Артефакт:** `Services`

**Ответственности:**

* Формирование персонализированных рекомендаций;
* Анализ профиля пользователя;
* Анализ истории оценок;
* Генерация списка рекомендованных игр.

---

### 2.8 Database

**Тип:** компонент  
**Артефакт:** `DB`

**Ответственности:**

* Хранение всех данных системы;
* Обеспечение транзакционной целостности;
* Предоставление данных сервисным компонентам.

---

## 3. Интерфейсы компонентов

### 3.1 Внешний API (CoreApp)

CoreApp предоставляет REST API для клиентского интерфейса:

* `POST /api/login` — аутентификация пользователя
* `GET /api/recommendations` — получение рекомендаций
* `GET /api/game/{id}` — получение информации об игре
* `POST /api/rating` — сохранение оценки
* `POST /api/review` — сохранение отзыва

---

### 3.2 Внутренние интерфейсы сервисных компонентов

Взаимодействие между CoreApp и менеджерами осуществляется через внутренние сервисные интерфейсы:

* `authenticate(credentials)`
* `getUserProfile(userId)`
* `getUserRatings(userId)`
* `getGameById(gameId)`
* `getGamesByIds(ids)`
* `saveRating(userId, gameId, rating)`
* `generateRecommendations(profile, ratings)`

---

## 4. Структуры данных, передаваемые через интерфейсы

### 4.1 Учётные данные пользователя

```json
{
  "email": "user@example.com",
  "password": "********"
}
```

---

### 4.2 Профиль пользователя

```json
{
  "userId": "uuid",
  "preferredGenres": ["RPG", "Action"]
}
```

---

### 4.3 Игра

```json
{
  "gameId": "uuid",
  "title": "Game Title",
  "genres": ["RPG"],
  "description": "Game description",
  "rating": 4.5
}
```

---

### 4.4 Оценка и отзыв

```json
{
  "userId": "uuid",
  "gameId": "uuid",
  "rating": 5,
  "comment": "Great game!"
}
```

---

### 4.5 Рекомендации

```json
{
  "games": [
    {
      "gameId": "uuid",
      "title": "Recommended Game"
    }
  ]
}
```

---

## 5. Основные сценарии взаимодействия компонентов

### 5.1 Сценарий аутентификации пользователя

1. Пользователь вводит логин и пароль в User Interface;
2. UI отправляет запрос в CoreApp;
3. CoreApp передаёт данные в Auth Manager;
4. Auth Manager выполняет проверку данных в базе данных;
5. Результат аутентификации возвращается в CoreApp;
6. CoreApp отправляет ответ клиенту;
7. UI сохраняет токен и перенаправляет пользователя на страницу Explore.

---

### 5.2 Сценарий формирования рекомендаций

1. Пользователь открывает страницу Explore;
2. UI запрашивает рекомендации у CoreApp;
3. CoreApp получает профиль пользователя и его оценки;
4. В зависимости от наличия истории:

   * либо формируется список случайных игр;
   * либо Recommendation Manager генерирует персонализированные рекомендации;
5. CoreApp получает данные игр;
6. Результат отправляется в UI;
7. UI отображает список рекомендаций.

---

### 5.3 Сценарий взаимодействия с игрой

1. Пользователь выбирает игру;
2. UI запрашивает данные игры и отзывы;
3. CoreApp агрегирует информацию из Game Manager и Rating Manager;
4. UI отображает страницу игры;
5. Пользователь может выставить оценку и оставить отзыв;
6. Данные сохраняются в базе данных.

---

## 6. Диаграмма размещения

Система развёртывается на трёх узлах:

* **Client Device** — пользовательский интерфейс;
* **Application Server** — CoreApp и сервисные компоненты;
* **Database Server** — база данных.

Архитектура поддерживает подключение множества клиентских устройств к одному серверу приложений и централизованной базе данных.
